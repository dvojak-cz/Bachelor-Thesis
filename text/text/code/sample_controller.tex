\begin{lstfloat}
\begin{lstlisting}[
language=C,
caption={UkÃ¡zka CRD device},
label={sample:controller}
]
for {
  desired := getDesiredState()
  current := getCurrentState()
  if current != desired {
    makeChanges(desired, current)
  }
}
\end{lstlisting}
\end{lstfloat}